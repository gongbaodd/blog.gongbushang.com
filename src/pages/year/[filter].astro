---
import { FILTER_ENTRY, POST_COUNT_PER_PAGE } from '@/packages/consts';
import { getFilterByYearPage } from '@/packages/utils/filter';
import BlogListPage from '@/src/components/BlogListPage.astro';
import NotFound from "../404.astro";
import { getCounts } from '@/packages/utils/heatmap';

export const prerender = true;
export const getStaticPaths = getFilterByYearPage;

const { filter } = Astro.params;

const subTitle = filter.replaceAll("/", " | ");
const counts = await getCounts()
const isValid = Object.keys(counts).filter(k => k !== FILTER_ENTRY.ALL).includes(filter)
const totalPostsCount = Astro.props.posts.length;
---

{isValid ? <BlogListPage subTitle={subTitle} totalCount={totalPostsCount} filter={filter} entryType={FILTER_ENTRY.YEAR} /> : <NotFound />}
